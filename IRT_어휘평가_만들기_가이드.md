# IRT 어휘 진단 테스트를 만든 이야기

> 9,000개의 영어 단어 데이터베이스로 "똑똑한 시험"을 만든 전체 과정을
> 초등학생도 이해할 수 있도록 설명합니다.

---

## 목차

1. [이 프로젝트가 뭐예요?](#1-이-프로젝트가-뭐예요)
2. [보통 시험과 뭐가 달라요?](#2-보통-시험과-뭐가-달라요)
3. [준비물: 9,000개 단어 데이터베이스](#3-준비물-9000개-단어-데이터베이스)
4. [1단계: 수학 공식 만들기 (IRT 모델)](#4-1단계-수학-공식-만들기-irt-모델)
5. [2단계: 단어마다 "난이도 점수" 매기기](#5-2단계-단어마다-난이도-점수-매기기)
6. [3단계: 똑똑한 출제 로봇 만들기 (CAT 엔진)](#6-3단계-똑똑한-출제-로봇-만들기-cat-엔진)
7. [4단계: 6가지 문제 유형 만들기](#7-4단계-6가지-문제-유형-만들기)
8. [5단계: 오답 선택지 만들기 (함정 만들기)](#8-5단계-오답-선택지-만들기-함정-만들기)
9. [6단계: "언제 시험을 끝낼까?" 규칙 만들기](#9-6단계-언제-시험을-끝낼까-규칙-만들기)
10. [7단계: 시험 결과 분석하기](#10-7단계-시험-결과-분석하기)
11. [8단계: 웹사이트로 만들기](#11-8단계-웹사이트로-만들기)
12. [9단계: 인터넷에 올리기 (배포)](#12-9단계-인터넷에-올리기-배포)
13. [특별한 기능들](#13-특별한-기능들)
14. [전체 파일 구조](#14-전체-파일-구조)
15. [마무리: 이 프로젝트에서 배운 것](#15-마무리-이-프로젝트에서-배운-것)

---

## 1. 이 프로젝트가 뭐예요?

### 한 줄 요약

**"내 영어 어휘력이 정확히 얼마나 되는지 알려주는 똑똑한 시험"** 을 만든 프로젝트예요.

### 비유로 이해하기

병원에 가면 키와 몸무게를 재죠? 그런데 영어 실력은 어떻게 잴까요?

보통 시험은 정해진 문제를 모두 풀게 해요. 100문제짜리 시험지를 처음부터 끝까지 다 풀어야 하죠.

우리가 만든 시험은 달라요. **의사 선생님처럼** 행동해요:

```
의사: "여기 아파요?"  →  환자: "아니요"
의사: "그럼 여기는요?"  →  환자: "네, 아파요!"
의사: "이 부근을 더 자세히 봅시다..."
```

우리 시험도 이렇게 해요:

```
시험: "apple이 뭔 뜻이야?"  →  학생: "사과!" (정답!)
시험: "그럼 조금 어려운 거... elaborate는?"  →  학생: "모르겠어요"
시험: "좀 더 쉬운 거 줄게... explain은?"  →  학생: "설명하다!" (정답!)
시험: "좋아, 네 실력이 이 정도구나!"
```

**15~40문제만 풀면** 100문제짜리 시험만큼 정확하게 실력을 알 수 있어요!

---

## 2. 보통 시험과 뭐가 달라요?

| | 보통 시험 | 우리의 IRT 시험 |
|---|---|---|
| 문제 수 | 100개 고정 | 15~40개 (사람마다 다름) |
| 문제 순서 | 모두에게 같음 | 사람마다 다름 |
| 난이도 | 섞여 있음 | 내 실력에 맞춰 조절 |
| 결과 | "78점" 숫자 하나 | CEFR 레벨 + 어휘 수 + 5차원 분석 |
| 걸리는 시간 | 30분 이상 | 보통 10~15분 |

### 핵심 아이디어 3가지

```
1. IRT (문항반응이론)  →  수학으로 "이 문제가 얼마나 어려운지" 계산
2. CAT (컴퓨터적응검사)  →  네 답에 따라 다음 문제를 골라줌
3. 5D 분석 (5차원)  →  어휘력을 여러 각도에서 분석
```

---

## 3. 준비물: 9,000개 단어 데이터베이스

### 단어 하나에 담긴 정보

시험을 만들려면 먼저 단어를 모아야 해요. 우리는 **9,000개의 영어 단어**를 모았어요.

그런데 단순히 "apple = 사과"만 적은 게 아니에요. 단어 하나마다 **50가지 이상의 정보**가 들어있어요!

```
단어: "elaborate"
├── 기본 정보
│   ├── 뜻 (한국어): 정교한, 상세히 설명하다
│   ├── 뜻 (영어): to explain in detail
│   ├── 품사: 형용사, 동사
│   └── 발음: /ɪˈlæbərət/
│
├── 난이도 정보
│   ├── CEFR 레벨: B2 (중상급)
│   ├── 빈도 순위: 3,241번째로 많이 쓰이는 단어
│   ├── 한국 교육과정: 고등학교 수준
│   ├── GSE 점수: 62
│   └── Lexile 레벨: 1100L
│
├── 관계 정보
│   ├── 비슷한 말(동의어): detailed, complex, intricate
│   ├── 반대말(반의어): simple, plain
│   ├── 상위어: explain
│   ├── 하위어: embellish
│   └── 같이 쓰는 말(연어): elaborate plan, elaborate on
│
├── 활용 정보
│   ├── 예문 1: "She gave an elaborate explanation."
│   ├── 예문 2: "Could you elaborate on that point?"
│   ├── 예문 3: "The cake had an elaborate design."
│   ├── 단어 가족: elaboration, elaborately
│   └── 어원: 라틴어 elaborare (열심히 일하다)
│
└── 분류 정보
    ├── 주제: communication (소통)
    ├── Oxford 3000: 아니오
    └── 교육적 가치: 높음
```

### 데이터 정리 (청소 작업)

9,000개 단어를 모으면 지저분한 데이터가 많아요. 프로그램이 이해할 수 있게 정리해야 해요.

```
❌ 정리 전:  GSE 점수 = "62점"       →  ⭕ 정리 후: 62 (숫자만)
❌ 정리 전:  동의어 = "big|large|huge" →  ⭕ 정리 후: ["big", "large", "huge"] (목록으로)
❌ 정리 전:  빈도 = ""  (비어있음!)    →  ⭕ 정리 후: 5000 (기본값 넣기)
❌ 정리 전:  교육가치 = "2024-01-15"   →  ⭕ 정리 후: "medium" (실수로 들어간 날짜 제거!)
```

> **파일 위치**: `irt_cat_engine/data/load_vocabulary.py`
> 이 파일이 9,000개 단어를 읽고 깨끗하게 정리하는 역할을 해요.

### 주제 분류

3,300개나 되는 주제 이름을 **27개 카테고리**로 정리했어요:

```
"일상생활"  "감정"  "행동"  "자연"  "동물"  "건강"  "음식"
"사회"  "교육"  "과학"  "시간"  "여행"  "사업"  "스포츠"  ...
```

이렇게 정리하면 "이 학생은 과학 관련 단어는 잘 아는데, 감정 관련 단어는 약하구나"라고 분석할 수 있어요.

> **파일 위치**: `irt_cat_engine/data/topic_mapper.py`

---

## 4. 1단계: 수학 공식 만들기 (IRT 모델)

### IRT가 뭐예요?

**IRT**는 "Item Response Theory"의 줄임말이에요. 한국어로는 **"문항반응이론"**이라고 해요.

쉽게 말하면: **"이 학생이 이 문제를 맞힐 확률을 계산하는 수학 공식"** 이에요.

### 비유: 게임 레벨

RPG 게임을 생각해 봐요:

```
내 레벨: 50     몬스터 레벨: 30  →  이길 확률 높음! (95%)
내 레벨: 50     몬스터 레벨: 50  →  반반! (50%)
내 레벨: 50     몬스터 레벨: 70  →  이길 확률 낮음... (15%)
```

IRT에서도 비슷해요:

```
내 실력(θ): 1.0    단어 난이도(b): -1.0  →  맞힐 확률 높음! (88%)
내 실력(θ): 1.0    단어 난이도(b):  1.0  →  반반! (50%)
내 실력(θ): 1.0    단어 난이도(b):  3.0  →  맞힐 확률 낮음... (12%)
```

### 핵심 공식

학생의 실력을 **θ(세타)**라고 부르고, 단어의 난이도를 **b**라고 불러요.

```
맞힐 확률 = 1 / (1 + e^(-a × (θ - b)))
```

이게 뭔 소리냐고요? 그림으로 보면 쉬워요:

```
맞힐 확률
100% ┤                          ·········
     │                     ····
 75% ┤                 ···
     │              ··
 50% ┤─ ─ ─ ─ ─ ─·─ ─ ─ ─ ─ ─ ─ ← 실력 = 난이도일 때 딱 50%!
     │          ··
 25% ┤       ···
     │   ····
  0% ┤····
     └──────────────────────────
     낮은 실력          높은 실력
```

**핵심 포인트:**
- 내 실력(θ)이 문제 난이도(b)보다 높으면 → 맞힐 확률이 높아요
- 내 실력이 문제 난이도와 같으면 → 딱 50% 확률이에요
- 내 실력이 문제 난이도보다 낮으면 → 맞힐 확률이 낮아요

### 공식에 들어가는 숫자들

| 기호 | 이름 | 뜻 | 범위 |
|------|------|-----|------|
| **θ** (세타) | 학생 실력 | 학생이 얼마나 잘하는지 | -3.0 ~ +3.0 |
| **b** | 난이도 | 문제가 얼마나 어려운지 | -3.0 ~ +3.0 |
| **a** | 변별도 | 문제가 실력 차이를 얼마나 잘 구분하는지 | 0.3 ~ 2.5 |

**θ(세타)** 값의 의미:

```
θ = -2.0  →  영어 입문자 (초등 저학년)
θ = -1.0  →  초급 (초등 고학년)
θ =  0.0  →  중급 (중학생)
θ = +1.0  →  중상급 (고등학생)
θ = +2.0  →  고급 (대학생/성인)
```

### 변별도(a)가 뭐예요?

**변별도**는 "이 문제가 잘하는 학생과 못하는 학생을 얼마나 잘 구분하느냐"예요.

```
변별도가 높은 문제 (a=2.0)         변별도가 낮은 문제 (a=0.5)

100% ┤           ·····              100% ┤              ·····
     │          ·                        │          ···
 50% ┤─ ─ ─ ─·─ ─ ─               50% ┤─ ─ ─··─ ─ ─ ─
     │       ·                          │     ···
  0% ┤·····                          0% ┤·····
     └──────────────                    └──────────────

  → 급격히 변함 (잘 구분!)           → 천천히 변함 (구분 안됨)
```

변별도가 높은 문제가 더 좋은 문제예요. "실력이 조금만 달라도 결과가 확실히 달라지니까요!"

> **파일 위치**: `irt_cat_engine/models/irt_2pl.py`
> 이 파일에 확률 계산, 정보량 계산 공식이 모두 들어있어요.

---

## 5. 2단계: 단어마다 "난이도 점수" 매기기

### 문제: 9,000개 단어의 난이도를 어떻게 정할까?

보통은 수천 명의 학생에게 시험을 보게 하고, 결과를 분석해서 난이도를 정해요.
하지만 우리는 아직 아무도 시험을 안 봤잖아요!

**해결책:** 단어가 가지고 있는 정보를 조합해서 난이도를 "추정"해요.

### 난이도(b) 계산 방법

5가지 정보를 섞어서 계산해요. 각각 중요도(가중치)가 달라요:

```
난이도 = CEFR 레벨 × 35%     ← 가장 중요!
       + 빈도 순위  × 25%     ← 자주 쓰는 단어일수록 쉬움
       + GSE 점수   × 20%
       + 교육과정   × 10%
       + Lexile     × 10%
```

#### 예시: "apple"의 난이도 계산

```
CEFR = A1 (매우 쉬움)  →  0.05  ×  0.35 = 0.0175
빈도 = 상위 500위      →  0.03  ×  0.25 = 0.0075
GSE = 22               →  0.10  ×  0.20 = 0.0200
교육과정 = 초등         →  0.10  ×  0.10 = 0.0100
Lexile = 200L          →  0.05  ×  0.10 = 0.0050
────────────────────────────────────────
합계 = 0.06 → 이걸 특별한 변환(프로빗)을 거치면 → b = -1.55 (매우 쉬움!)
```

#### 예시: "elaborate"의 난이도 계산

```
CEFR = B2 (중상급)     →  0.60  ×  0.35 = 0.2100
빈도 = 3241위          →  0.36  ×  0.25 = 0.0900
GSE = 62               →  0.55  ×  0.20 = 0.1100
교육과정 = 고교        →  0.70  ×  0.10 = 0.0700
Lexile = 1100L         →  0.65  ×  0.10 = 0.0650
────────────────────────────────────────
합계 = 0.545 → 프로빗 변환 → b = 0.11 (약간 어려움)
```

### 변별도(a) 계산 방법

기본값 1.0에서 시작해서 조건에 따라 올리거나 내려요:

```
기본 변별도: 1.0

조정 요인:
  ├── 동의어가 많으면  → 낮춤 (비슷한 뜻이 많으면 구분이 어려우니까)
  ├── 교육적 가치 높으면 → 올림 (중요한 단어는 실력 차이가 잘 드러나니까)
  ├── 주제가 특수하면  → 올림 (전문 단어를 아는 건 실력 차이)
  ├── 명사/동사이면   → 올림 (핵심 품사)
  └── Oxford 3000이면 → 약간 낮춤 (너무 기본적인 단어라 다들 아니까)
```

> **파일 위치**: `irt_cat_engine/item_bank/parameter_initializer.py`

---

## 6. 3단계: 똑똑한 출제 로봇 만들기 (CAT 엔진)

### CAT가 뭐예요?

**CAT**는 "Computerized Adaptive Testing"의 줄임말이에요.
한국어로는 **"컴퓨터 적응형 검사"**라고 해요.

쉽게 말하면: **"네가 문제를 풀 때마다, 다음에 줄 문제를 컴퓨터가 골라주는 시험"** 이에요.

### 출제 로봇의 작동 원리

```
┌─────────────────────────────────────────────┐
│              CAT 엔진의 한 사이클             │
│                                             │
│  ① 학생 실력 추정 (지금까지 답한 걸로 계산)     │
│         ↓                                   │
│  ② 가장 유용한 문제 찾기 (9,000개 중에서)      │
│         ↓                                   │
│  ③ 문제 출제                                │
│         ↓                                   │
│  ④ 학생이 답함                               │
│         ↓                                   │
│  ⑤ 실력 다시 계산                            │
│         ↓                                   │
│  ⑥ 시험 끝낼지 확인 → 아니면 ①로 돌아감       │
│                                             │
└─────────────────────────────────────────────┘
```

### ② "가장 유용한 문제 찾기" — 핵심!

이게 CAT의 핵심이에요. **"지금 이 학생에게 가장 많은 정보를 주는 문제"**를 골라요.

#### 피셔 정보량이란?

```
피셔 정보량 = a² × P × (1 - P)
```

- **P**는 맞힐 확률이에요
- **P가 50%일 때** 정보량이 가장 커요!

왜냐면:
- 너무 쉬운 문제 (P=95%) → 맞혀도 당연하고, 새로운 정보가 없음
- 너무 어려운 문제 (P=5%) → 틀려도 당연하고, 새로운 정보가 없음
- **딱 맞는 문제 (P=50%)** → 맞히냐 틀리냐에 따라 실력을 가장 잘 알 수 있음!

```
정보량
높음 ┤        ···
     │      ··   ··
     │     ·       ·
     │    ·         ·
     │   ·           ·
낮음 ┤···               ···
     └──────────────────────
     너무 쉬움   딱 맞음   너무 어려움
```

#### 예시로 보기

학생의 현재 추정 실력이 θ = 0.5라면:

```
단어 A: b = -2.0  →  너무 쉬움  →  정보량: 0.05 (별로!)
단어 B: b =  0.3  →  딱 맞음!  →  정보량: 0.92 (최고!)
단어 C: b =  3.0  →  너무 어려움 →  정보량: 0.03 (별로!)

→ 단어 B를 출제!
```

### 출제할 때 지키는 규칙들

정보량만 보고 문제를 고르면 비슷한 문제만 계속 나올 수 있어요.
그래서 여러 가지 규칙을 추가했어요:

```
규칙 1: 같은 주제에서 최대 3문제 (편중 방지)
규칙 2: 외래어(computer, banana 등)는 최대 2문제
규칙 3: 이미 낸 문제는 다시 안 냄
규칙 4: 문제 유형을 골고루 섞기
규칙 5: 특정 단어가 너무 자주 출제되지 않게 관리
규칙 6: 정보량 상위 5개 중 랜덤 선택 (시험이 매번 달라지도록)
```

### ⑤ 실력 다시 계산하기 (EAP 방법)

학생이 한 문제를 풀 때마다 실력(θ)을 다시 계산해요.

**EAP(Expected A Posteriori)**라는 방법을 써요. 비유로 설명하면:

```
처음: "이 학생 실력은 아마 0.0쯤일 거야" (추측)
      ↓
1번 맞힘: "0.0보다는 높을 듯! → θ = 0.3"
2번 맞힘: "더 높을 듯! → θ = 0.6"
3번 틀림: "조금 낮춰야겠다 → θ = 0.4"
4번 맞힘: "다시 올려 → θ = 0.5"
...
15번째: "θ = 0.52 ± 0.28 (꽤 확실해졌다!)"
```

구체적으로는:
1. θ가 될 수 있는 값을 41개 점으로 나눔 (-4.0부터 +4.0까지)
2. 각 점에서 "지금까지 답한 패턴이 나올 확률"을 계산
3. 확률이 높은 곳의 평균 = 추정 실력(θ)
4. 얼마나 퍼져있는지 = 오차(SE)

> **파일 위치:**
> - CAT 세션: `irt_cat_engine/cat/session.py`
> - 문제 선택: `irt_cat_engine/cat/item_selector.py`
> - 실력 추정: `irt_cat_engine/models/ability_estimator.py`

---

## 7. 4단계: 6가지 문제 유형 만들기

단어를 아는 걸 확인하는 방법은 여러 가지예요. 우리는 6가지 유형을 만들었어요!

### 유형 1: 한국어 뜻 고르기 (가장 기본)

```
┌──────────────────────────────────┐
│  "elaborate"의 뜻은?              │
│                                  │
│  ① 정교한, 상세히 설명하다  ✅     │
│  ② 간단한                        │
│  ③ 빠른                         │
│  ④ 무거운                        │
└──────────────────────────────────┘
```

### 유형 2: 영어 정의 고르기

```
┌──────────────────────────────────────────┐
│  "elaborate" — Choose the definition:     │
│                                          │
│  ① to explain in detail  ✅               │
│  ② to move quickly                       │
│  ③ to feel sad                           │
│  ④ to build something                    │
└──────────────────────────────────────────┘
```

### 유형 3: 비슷한 말(동의어) 고르기

```
┌──────────────────────────────────┐
│  "elaborate"와 비슷한 뜻의 단어는? │
│                                  │
│  ① detailed  ✅                   │
│  ② simple                       │
│  ③ fast                         │
│  ④ heavy                        │
└──────────────────────────────────┘
```

### 유형 4: 반대말(반의어) 고르기

```
┌──────────────────────────────────┐
│  "elaborate"와 반대 뜻의 단어는?   │
│                                  │
│  ① simple  ✅                     │
│  ② detailed                     │
│  ③ complex                      │
│  ④ intricate                    │
└──────────────────────────────────┘
```

### 유형 5: 문장 빈칸 채우기

```
┌──────────────────────────────────────────────┐
│  빈칸에 알맞은 단어는?                          │
│                                              │
│  "She gave an _______ explanation            │
│   of the project."                           │
│                                              │
│  ① elaborate  ✅                               │
│  ② simple                                    │
│  ③ fast                                      │
│  ④ heavy                                     │
└──────────────────────────────────────────────┘
```

### 유형 6: 연어 판단 (같이 쓰는 말)

```
┌──────────────────────────────────────────┐
│  "elaborate plan"은 자연스러운 표현인가요?  │
│                                          │
│       ⭕ 맞다           ❌ 아니다          │
│       ✅                                 │
└──────────────────────────────────────────┘
```

### 유형별 난이도 보정

같은 단어라도 문제 유형에 따라 난이도가 달라져요!

```
유형 1 (한국어 뜻)    : 기본 난이도 + 0.0  ← 가장 쉬움
유형 2 (영어 정의)    : 기본 난이도 + 0.3
유형 3 (동의어)       : 기본 난이도 + 0.4
유형 4 (반의어)       : 기본 난이도 + 0.5
유형 5 (문장 빈칸)    : 기본 난이도 + 0.6  ← 가장 어려움
유형 6 (연어 판단)    : 기본 난이도 + 0.2
```

"apple"의 뜻을 아는 것(유형1)보다 "apple"이 들어간 문장의 빈칸을 채우는 것(유형5)이 더 어렵잖아요!

### 혼합 모드: 문제 유형을 섞어서 내기

시험을 시작할 때 "혼합(추천)" 모드를 선택하면, 시험이 진행되면서 점점 다양한 유형이 나와요:

```
문제 1~4번:   유형 1, 2만 (워밍업! 기본적인 것부터)
문제 5~14번:  유형 1, 2, 3, 5 (좀 더 다양하게)
문제 15번~:   유형 1~6 전부! (본격 평가)
```

이렇게 하면 처음에는 쉬운 유형으로 긴장을 풀고, 점점 어려운 유형을 섞어요!

> **파일 위치**: `irt_cat_engine/api/session_manager.py` (유형 선택 로직)

---

## 8. 5단계: 오답 선택지 만들기 (함정 만들기)

### 왜 오답이 중요해요?

4지선다 문제에서 정답은 정해져 있어요. 하지만 **나머지 3개 오답**이 잘 만들어져야 좋은 문제예요!

```
나쁜 오답 예시:                좋은 오답 예시:
"happy"의 뜻은?              "happy"의 뜻은?
① 행복한 ✅                  ① 행복한 ✅
② 자동차                     ② 즐거운 (비슷하지만 다른 뜻)
③ 컴퓨터                     ③ 화난 (감정인데 반대)
④ 사과                      ④ 걱정하는 (감정인데 다른 감정)

→ 아무나 맞힐 수 있음!        → 정말 아는 사람만 맞힘!
```

### 4가지 오답 생성 전략

우리는 4가지 방법으로 "그럴듯한 오답"을 만들어요:

#### 전략 A: 같은 품사 + 비슷한 난이도

```
정답: "elaborate" (형용사, B2)
오답 후보: 같은 형용사 + B1~B2 레벨에서 고름
→ "simple", "various", "obvious"
```

규칙: 동의어는 오답에서 제외! ("detailed"는 elaborate의 동의어니까 오답으로 쓰면 안 돼요)

#### 전략 B: 비슷한 말 제외하기

동의어 문제(유형3)의 오답을 만들 때 써요:

```
정답: "detailed" (elaborate의 동의어)
오답 후보: elaborate의 동의어가 아닌 단어들
→ "simple", "rapid", "gentle"
```

#### 전략 C: 반대말 제외하기

반의어 문제(유형4)의 오답을 만들 때 써요:

```
정답: "simple" (elaborate의 반의어)
오답 후보: elaborate의 반의어가 아닌 단어들
→ "detailed", "complex", "intricate"
```

#### 전략 D: 단어 그래프 활용

단어들의 관계를 그래프(네트워크)로 만들어서 "비슷해 보이지만 다른 단어"를 찾아요:

```
        동물 (상위어)
       / | \
     개  고양이  토끼    ← 이 단어들은 "형제" 관계

"개"의 동의어 문제:
정답: "puppy"
오답: "고양이", "토끼" ← 같은 "동물" 범주라 헷갈리게!
```

이 방법이 가장 교묘한 함정을 만들어요. 완전 다른 단어가 아니라, "비슷한 범주에 있지만 다른 뜻"인 단어를 고르니까요!

### 오답 품질 검증

만들어진 오답은 이런 검증을 거쳐요:

```
✓ 정답과 동의어가 아닌가?
✓ 정답과 같은 한국어 뜻을 가지고 있지 않은가?
✓ 정답의 단어 가족이 아닌가? (elaborate / elaboration)
✓ 오답끼리 서로 동의어가 아닌가?
```

> **파일 위치**: `irt_cat_engine/item_bank/distractor_engine.py`

---

## 9. 6단계: "언제 시험을 끝낼까?" 규칙 만들기

### 문제: 몇 문제를 풀면 충분할까?

어떤 학생은 15문제만 풀어도 실력을 알 수 있고, 어떤 학생은 30문제가 필요할 수 있어요.
그래서 **"이제 충분히 알았다!"**를 판단하는 규칙이 필요해요.

### 3가지 종료 규칙

```
규칙 1: 최소 문항 수 (안전장치)
├── 15문제는 무조건 풀어야 함
└── 이유: 너무 적은 문제로는 정확한 판단이 불가능

규칙 2: 최대 문항 수 (제한)
├── 40문제가 되면 무조건 끝
└── 이유: 너무 많으면 피곤해서 집중 못 함

규칙 3: 정밀도 달성 (똑똑한 판단)
├── 표준 오차(SE)가 0.30 미만이면 끝
├── 또는 최근 5번의 실력 추정치가 거의 같으면 끝
└── 이유: "더 풀어도 결과가 안 변할 거야"
```

### 비유: 저울로 무게 재기

```
1번째 측정: 52kg (불확실...)
2번째 측정: 48kg (여전히 흔들려...)
3번째 측정: 51kg
4번째 측정: 50kg
5번째 측정: 50.5kg
6번째 측정: 50.2kg  ← "계속 50kg 근처! 이제 됐다!"

→ "이 사람의 몸무게는 약 50kg (오차 ±0.3kg)"
```

CAT도 마찬가지! 실력 추정치가 더 이상 크게 변하지 않으면 시험을 끝내요.

### 실제 시나리오

```
[잘하는 학생]
문제 1~15: 대부분 정답 → θ = 1.5, SE = 0.28 → 15번에서 끝! (빠르게 확인)

[보통 학생]
문제 1~15: 반반 → SE = 0.35 (아직 불확실)
문제 16~22: 약간 더 정보 수집 → SE = 0.29 → 22번에서 끝!

[불규칙한 학생]
문제 1~15: 맞았다 틀렸다 반복 → SE = 0.40 (많이 불확실)
문제 16~35: 계속 불규칙 → SE = 0.32 (여전히...)
문제 36~40: → 40번 도달! → 강제 종료
```

> **파일 위치**: `irt_cat_engine/cat/stopping_rules.py`

---

## 10. 7단계: 시험 결과 분석하기

시험이 끝나면 단순히 "78점"이 아니라, **아주 자세한 분석 결과**를 만들어요!

### 결과 1: CEFR 레벨

CEFR은 유럽에서 만든 언어 능력 등급이에요. 전 세계에서 사용해요.

```
A1 ▓░░░░░  입문 — 매우 기본적인 단어만 아는 수준
A2 ▓▓░░░░  초급 — 일상적인 단어를 아는 수준
B1 ▓▓▓░░░  중급 — 대부분의 일상 단어를 아는 수준
B2 ▓▓▓▓░░  중상급 — 전문적인 주제도 이해하는 수준
C1 ▓▓▓▓▓░  고급 — 학술/전문 단어도 잘 아는 수준
```

θ 값으로 CEFR을 결정해요:

```
θ < -1.5   →  A1
-1.5 ≤ θ < -0.5  →  A2
-0.5 ≤ θ < 0.5   →  B1
 0.5 ≤ θ < 1.5   →  B2
 1.5 ≤ θ         →  C1
```

그리고 각 레벨일 확률도 계산해요:
```
"이 학생의 CEFR 레벨은 B1입니다"
  A1: 2%  |  A2: 15%  |  B1: 48%  |  B2: 30%  |  C1: 5%
```

### 결과 2: 추정 어휘 수

"이 학생이 알고 있는 단어가 대략 몇 개인지" 계산해요.

```
방법: 9,000개 단어 각각에 대해 "이 학생이 이 단어를 알 확률"을 계산하고, 다 더함!

예시 (θ = 0.5인 학생):
  apple (b=-1.5):    맞힐 확률 88%  →  0.88개
  book (b=-1.0):     맞힐 확률 82%  →  0.82개
  ...
  elaborate (b=0.5): 맞힐 확률 50%  →  0.50개
  ...
  ubiquitous (b=2.5): 맞힐 확률 12% →  0.12개

  전부 더하면 → 약 4,200단어!
```

### 결과 3: 5차원 어휘 프로필

어휘력을 5가지 각도에서 분석해요:

```
        의미 이해
          ▲
     100% │ ★
          │   ╲
 관계 이해├─────●─── 문맥 이해
          │   ╱
          │ ●
          │
   화용────┴──── 형태

★ 강점: 의미 이해 (85%)
● 보통: 관계 이해 (62%), 문맥 이해 (58%)
● 약점: 형태 (45%), 화용 (40%)
```

| 차원 | 뜻 | 관련 문제 유형 |
|------|-----|--------------|
| 의미(Semantic) | 단어의 뜻을 알아요? | 유형 1, 2 |
| 관계(Relational) | 비슷한 말/반대말을 알아요? | 유형 3, 4 |
| 문맥(Contextual) | 문장에서 어떻게 쓰이는지 알아요? | 유형 5, 6 |
| 형태(Form) | 단어의 변형을 알아요? (run→running) | (미래 유형) |
| 화용(Pragmatic) | 격식/비격식 차이를 알아요? | (미래 유형) |

### 결과 4: 주제별 강약점

```
강점 영역 ✅                 보완 영역 ⚠️
├── 일상생활: 92%            ├── 과학: 45%
├── 감정: 88%               ├── 정치/사회: 38%
└── 음식: 85%               └── 학술: 42%
```

### 결과 5: 맞춤 학습 계획

```
📚 4주 학습 로드맵

1주차: "문맥 이해" 집중 훈련
  - 매일 빈칸 채우기 연습 5문제
  - 연어(collocation) 학습

2주차: "관계 이해" 강화
  - 동의어/반의어 짝 맞추기
  - 유의어 뉘앙스 차이 학습

3주차: 종합 복습
  - 약점 주제(과학, 사회) 단어 집중

4주차: 재테스트 + 복습
  - 다시 시험 보기를 추천!
```

> **파일 위치:**
> - 점수 매핑: `irt_cat_engine/reporting/score_mapper.py`
> - 5차원 분석: `irt_cat_engine/reporting/dimension_analyzer.py`
> - 학습 추천: `irt_cat_engine/reporting/recommendation_engine.py`
> - 어휘 매트릭스: `irt_cat_engine/reporting/matrix_generator.py`

---

## 11. 8단계: 웹사이트로 만들기

### 구조: 프론트엔드 + 백엔드

```
┌─────────────────┐     인터넷     ┌─────────────────┐
│    프론트엔드     │ ◄──────────► │     백엔드       │
│   (화면 담당)    │   API 통신    │   (두뇌 담당)    │
│                 │              │                 │
│  React + TS     │              │  FastAPI + Python│
│  Vercel에 배포   │              │  Cloud Run에 배포 │
└─────────────────┘              └─────────────────┘
    사용자가 보는                    계산하는
    예쁜 화면                       똑똑한 서버
```

### 프론트엔드 (화면)

React로 만든 3개의 화면이 있어요:

#### 화면 1: 설문 화면 (SurveyScreen)

```
┌──────────────────────────────────┐
│   IRT 어휘 진단 테스트              │
│                                  │
│   닉네임: [_________]             │
│                                  │
│   학년:  [초3-4] [초5-6] [중1]     │
│          [중2]   [중3]   [고1]    │
│          [고2]   [고3]   [대학]    │
│                                  │
│   자기평가: [초급] [중급] [고급]     │
│                                  │
│   문항 유형: [혼합(추천)] [한국어뜻]  │
│             [영어정의] [동의어] ...  │
│                                  │
│        [테스트 시작]               │
└──────────────────────────────────┘
```

#### 화면 2: 테스트 화면 (TestScreen)

```
┌──────────────────────────────────┐
│   3번 문항          정답률: 67%    │
│   ■■■■■■□□□□□□□□□  3/20         │
│                                  │
│   "elaborate"의 뜻은?             │
│                                  │
│   ┌──────────────────────┐       │
│   │ ① 정교한, 상세히 설명하다 │      │
│   └──────────────────────┘       │
│   ┌──────────────────────┐       │
│   │ ② 간단한               │      │
│   └──────────────────────┘       │
│   ┌──────────────────────┐       │
│   │ ③ 빠른                │       │
│   └──────────────────────┘       │
│   ┌──────────────────────┐       │
│   │ ④ 무거운               │      │
│   └──────────────────────┘       │
│                                  │
│            [모름]                 │
└──────────────────────────────────┘
```

#### 화면 3: 결과 화면 (ResultsScreen)

```
┌──────────────────────────────────┐
│        진단 결과                   │
│                                  │
│   CEFR 레벨: B1                  │
│   추정 어휘 수: 4,200 / 9,183     │
│   신뢰도: 91%                    │
│                                  │
│   [5차원 레이더 차트]               │
│   [CEFR 확률 분포 그래프]           │
│   [주제별 강약점]                   │
│   [학습 추천]                      │
│                                  │
│        [다시 테스트하기]             │
└──────────────────────────────────┘
```

### 백엔드 (서버)

FastAPI로 만든 API 서버예요. 주요 역할:

```
요청: "시험 시작해 주세요!"
  → POST /api/v1/test/start
  → 사용자 등록, CAT 세션 생성, 첫 번째 문제 반환

요청: "3번 보기를 골랐어요!"
  → POST /api/v1/test/{세션ID}/respond
  → 정답 확인, 실력 재계산, 다음 문제 반환 (또는 시험 종료)

요청: "결과 보여주세요!"
  → GET /api/v1/test/{세션ID}/results
  → CEFR, 어휘 수, 5차원 분석, 학습 계획 반환
```

### 프론트엔드와 백엔드의 대화

```
[프론트엔드]                          [백엔드]

"시험 시작!" ──────────────────────→  사용자 생성
                                    CAT 세션 시작
             ←──────────────────── "첫 번째 문제: apple"

"① 사과 선택!" ──────────────────→   정답! θ 재계산
                                    다음 문제 선택
             ←──────────────────── "2번째 문제: elaborate"

"③ 빠른 선택!" ──────────────────→   오답! θ 재계산
                                    다음 문제 선택
             ←──────────────────── "3번째 문제: explain"

... (반복) ...

"② 설명하다 선택!" ──────────────→   정답! SE 충분히 낮음!
                                    시험 종료!
             ←──────────────────── "결과: B1, 4200단어, ..."
```

> **파일 위치:**
> - 프론트엔드: `irt_cat_engine/frontend/src/` 폴더 전체
> - 백엔드 API: `irt_cat_engine/api/routes_test.py`
> - 세션 관리: `irt_cat_engine/api/session_manager.py`

---

## 12. 9단계: 인터넷에 올리기 (배포)

만든 웹사이트를 전 세계 누구나 쓸 수 있게 인터넷에 올려야 해요!

### 프론트엔드 배포: Vercel

**Vercel**은 웹사이트를 무료로 올릴 수 있는 서비스예요.

```
내 컴퓨터의 React 코드
    ↓ (업로드)
Vercel이 자동으로 빌드
    ↓
https://vocab-cat-test.vercel.app ← 완성!
```

### 백엔드 배포: Google Cloud Run

**Cloud Run**은 구글 클라우드에서 서버를 실행하는 서비스예요.

```
내 컴퓨터의 Python 코드
    ↓ (Docker 컨테이너로 포장)
Google Cloud에 업로드
    ↓
https://vocab-cat-api-xxxxx.run.app ← 완성!
```

#### Docker가 뭐예요?

프로그램을 실행하려면 Python, 라이브러리 등 여러 가지가 필요해요.
**Docker**는 이 모든 걸 하나의 "상자(컨테이너)"에 넣어서 어디서든 실행할 수 있게 해줘요.

```
┌─ Docker 컨테이너 ────────────┐
│                              │
│  Python 3.13                 │
│  + FastAPI                   │
│  + NumPy, SciPy              │
│  + 우리의 코드                │
│  + 9,000단어 데이터            │
│                              │
│  "이 상자만 있으면 어디서든     │
│   실행 가능!"                 │
└──────────────────────────────┘
```

### 전체 배포 구조

```
사용자의 브라우저
      │
      ▼
┌─────────────────┐
│  Vercel (프론트)  │  ← 화면(HTML/CSS/JS)만 전달
│  vocab-cat-test  │
│  .vercel.app     │
└────────┬────────┘
         │ API 호출
         ▼
┌─────────────────┐
│ Cloud Run (백엔드)│  ← 계산 처리 (IRT, CAT)
│ vocab-cat-api    │
│ .run.app         │
└────────┬────────┘
         │
         ▼
   ┌───────────┐
   │  SQLite   │  ← 결과 저장
   │  Database │
   └───────────┘
```

---

## 13. 특별한 기능들

### 외래어(Loanword) 처리

"computer", "banana", "chocolate" 같은 단어는 한국어에서도 거의 같은 발음이에요.

```
"computer"의 한국어 뜻은?
① 컴퓨터  ← 누구나 맞힐 수 있어요! 실력을 측정하는 데 도움이 안 됨!
```

그래서 외래어가 나오면 **자동으로 다른 유형으로 바꿔요**:

```
변경 전: "computer"의 한국어 뜻은? (유형1 → 의미 없음)
변경 후: "computer"와 비슷한 말은? (유형3 → 의미 있음!)
  ① device ✅
  ② animal
  ③ food
  ④ color
```

100개 이상의 외래어 목록을 관리하고, 시험당 최대 2개만 출제해요.

### "모름" 버튼

시험 볼 때 정말 모르는 문제가 나오면, 찍는 것보다 "모름"을 누르는 게 더 정확한 측정에 도움이 돼요.

```
보통 4지선다: 모르면 찍기 → 25% 확률로 맞힘 → 실력이 좀 높게 나옴
"모름" 누름:   확실히 모름  → 찍기 효과 제거 → 더 정확한 측정!
```

### 온라인 보정 (학습하는 시스템)

시험을 많은 사람이 볼수록 문제의 난이도가 더 정확해져요.

```
처음: "elaborate"의 난이도 = 0.5 (추정값)
     ↓ 100명이 시험을 봄
보정 후: "elaborate"의 난이도 = 0.38 (실제 데이터 기반!)
     ↓ 1,000명이 시험을 봄
재보정: "elaborate"의 난이도 = 0.42 (더 정확!)
```

이걸 **"베이지안 온라인 보정(Bayesian Online Calibration)"**이라고 해요.

### 한국어/영어 전환

버튼 하나로 전체 화면을 한국어 또는 영어로 바꿀 수 있어요.
모든 텍스트가 번역 파일에 한국어/영어 쌍으로 저장되어 있어요.

```javascript
// translations.ts 예시
appTitle:     { ko: "IRT 어휘 진단 테스트",  en: "IRT Vocabulary Diagnostic Test" },
startBtn:     { ko: "테스트 시작",           en: "Start Test" },
resultsTitle: { ko: "진단 결과",             en: "Diagnostic Results" },
```

---

## 14. 전체 파일 구조

```
vocabulary-db/                          ← 프로젝트 최상위 폴더
│
├── 9000word_full_db.csv                ← 📚 9,000단어 데이터베이스
├── Dockerfile                          ← 🐳 Docker 배포 설정
│
└── irt_cat_engine/                     ← 🧠 IRT CAT 엔진 메인 폴더
    │
    ├── config.py                       ← ⚙️ 설정값 모음
    │                                      (최소/최대 문항 수, SE 기준, 외래어 목록 등)
    │
    ├── models/                         ← 📐 수학 모델
    │   ├── irt_2pl.py                  ←   확률 계산, 정보량 계산
    │   └── ability_estimator.py        ←   실력(θ) 추정 (EAP, MLE)
    │
    ├── cat/                            ← 🤖 CAT 엔진
    │   ├── session.py                  ←   시험 한 세션 관리
    │   ├── item_selector.py            ←   "다음 문제 뭘 낼까?" 결정
    │   ├── stopping_rules.py           ←   "시험 끝낼까?" 판단
    │   └── diagnostic_report.py        ←   진단 보고서 생성
    │
    ├── item_bank/                      ← 📦 문제 은행
    │   ├── parameter_initializer.py    ←   단어→IRT 파라미터 변환
    │   ├── distractor_engine.py        ←   오답 선택지 생성
    │   └── calibrator.py              ←   온라인 보정
    │
    ├── data/                           ← 💾 데이터 관리
    │   ├── load_vocabulary.py          ←   CSV 파일 읽기 + 정리
    │   ├── graph_connector.py          ←   단어 관계 그래프
    │   ├── topic_mapper.py             ←   주제 분류
    │   ├── database.py                 ←   SQLite 연결
    │   └── db_models.py                ←   DB 테이블 정의
    │
    ├── reporting/                      ← 📊 결과 분석
    │   ├── score_mapper.py             ←   θ → CEFR, 어휘 수 변환
    │   ├── dimension_analyzer.py       ←   5차원 어휘 분석
    │   ├── recommendation_engine.py    ←   학습 계획 생성
    │   ├── matrix_generator.py         ←   어휘 매트릭스
    │   └── exposure_analysis.py        ←   문제 풀 관리
    │
    ├── api/                            ← 🌐 웹 API
    │   ├── main.py                     ←   서버 시작점
    │   ├── routes_test.py              ←   시험 관련 API
    │   ├── routes_admin.py             ←   관리자 API
    │   ├── routes_learn.py             ←   학습 관련 API
    │   ├── schemas.py                  ←   요청/응답 형식 정의
    │   └── session_manager.py          ←   세션 관리 (핵심!)
    │
    ├── frontend/                       ← 🎨 프론트엔드 (React)
    │   └── src/
    │       ├── App.tsx                 ←   메인 앱 (화면 전환)
    │       ├── components/             ←   화면 컴포넌트들
    │       │   ├── SurveyScreen.tsx    ←     설문 화면
    │       │   ├── TestScreen.tsx      ←     테스트 화면
    │       │   └── ResultsScreen.tsx   ←     결과 화면
    │       ├── i18n/                   ←   다국어 지원
    │       │   ├── translations.ts    ←     한국어/영어 번역
    │       │   └── LangContext.tsx     ←     언어 전환 관리
    │       └── hooks/
    │           └── useApi.ts           ←     서버 통신
    │
    └── tests/                          ← ✅ 테스트 (162개!)
        ├── test_irt_model.py           ←   수학 모델 테스트
        ├── test_cat_simulation.py      ←   CAT 시뮬레이션
        ├── test_api.py                 ←   API 테스트
        ├── test_phase4.py              ←   3PL + 보정 테스트
        ├── test_phase5.py              ←   외래어 + 모름 테스트
        ├── test_phase6.py              ←   5차원 분석 테스트
        ├── test_phase7.py              ←   어휘 추정 테스트
        └── test_real_data.py           ←   실제 데이터 테스트
```

---

## 15. 마무리: 이 프로젝트에서 배운 것

### 사용한 기술 총정리

| 분야 | 기술 | 역할 |
|------|------|------|
| 수학 | IRT (문항반응이론) | 문제 난이도와 학생 실력을 수학으로 연결 |
| 수학 | 베이지안 추정 (EAP) | 학생의 실력을 점점 정확하게 추정 |
| 수학 | 피셔 정보량 | "가장 유용한 문제" 선택 기준 |
| 백엔드 | Python + FastAPI | 서버(두뇌) 프로그래밍 |
| 백엔드 | NumPy, SciPy | 빠른 수학 계산 |
| 백엔드 | SQLite + SQLAlchemy | 결과 저장 |
| 프론트엔드 | React + TypeScript | 화면(얼굴) 프로그래밍 |
| 배포 | Docker | 프로그램을 "상자"에 포장 |
| 배포 | Google Cloud Run | 서버를 인터넷에 올림 |
| 배포 | Vercel | 화면을 인터넷에 올림 |
| 데이터 | CSV/TSV | 9,000단어 데이터베이스 |
| 테스트 | pytest | 코드가 잘 작동하는지 확인 (162개 테스트) |

### 이 프로젝트의 핵심 아이디어를 한 문장으로

> **"9,000개 단어의 풍부한 데이터 + IRT 수학 모델 + 적응형 출제 알고리즘으로,
> 15~40문제만으로 학생의 영어 어휘력을 CEFR 레벨, 추정 어휘 수, 5차원 프로필까지
> 정밀하게 진단하는 시스템"**

### 직접 해 보세요!

👉 **https://vocab-cat-test.vercel.app**

---

*이 문서는 vocabulary-db 프로젝트의 IRT CAT 어휘 진단 시스템 구축 과정을 정리한 것입니다.*
